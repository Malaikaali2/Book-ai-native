"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics_book=globalThis.webpackChunkphysical_ai_humanoid_robotics_book||[]).push([[8007],{3567(e,r,n){n.r(r),n.d(r,{assets:()=>c,contentTitle:()=>t,default:()=>u,frontMatter:()=>l,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"module-1-ros/lab-publisher-subscriber","title":"Hands-on Lab: Publisher/Subscriber Nodes","description":"Objective","source":"@site/docs/module-1-ros/lab-publisher-subscriber.md","sourceDirName":"module-1-ros","slug":"/module-1-ros/lab-publisher-subscriber","permalink":"/Book-ai-native/docs/module-1-ros/lab-publisher-subscriber","draft":false,"unlisted":false,"editUrl":"https://github.com/Malaikaali2/Book-ai-native/tree/main/docs/module-1-ros/lab-publisher-subscriber.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"tutorialSidebar","previous":{"title":"ROS 2 Architecture and Basic Concepts","permalink":"/Book-ai-native/docs/module-1-ros/fundamentals"},"next":{"title":"Advanced ROS 2 Topics: Services, Actions, and Parameters","permalink":"/Book-ai-native/docs/module-1-ros/advanced-topics"}}');var i=n(4848),a=n(8453);const l={sidebar_position:3},t="Hands-on Lab: Publisher/Subscriber Nodes",c={},o=[{value:"Objective",id:"objective",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Lab Setup",id:"lab-setup",level:2},{value:"Creating a New Package",id:"creating-a-new-package",level:3},{value:"Package Structure",id:"package-structure",level:3},{value:"Step 1: Creating the Publisher Node",id:"step-1-creating-the-publisher-node",level:2},{value:"Step 2: Creating the Subscriber Node",id:"step-2-creating-the-subscriber-node",level:2},{value:"Step 3: Configuring the Package",id:"step-3-configuring-the-package",level:2},{value:"Step 4: Building the Package",id:"step-4-building-the-package",level:2},{value:"Step 5: Running the Nodes",id:"step-5-running-the-nodes",level:2},{value:"Step 6: Advanced Exercise - Custom Message",id:"step-6-advanced-exercise---custom-message",level:2},{value:"Verification",id:"verification",level:2},{value:"Expected Outcome",id:"expected-outcome",level:2},{value:"References",id:"references",level:2}];function d(e){const r={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"hands-on-lab-publishersubscriber-nodes",children:"Hands-on Lab: Publisher/Subscriber Nodes"})}),"\n",(0,i.jsx)(r.h2,{id:"objective",children:"Objective"}),"\n",(0,i.jsx)(r.p,{children:"Create and deploy a basic ROS 2 package with multiple nodes communicating over topics (Quigley et al., 2009). This lab will help you understand the fundamental publish-subscribe communication pattern in ROS 2."}),"\n",(0,i.jsx)(r.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"ROS 2 Humble Hawksbill installed"}),"\n",(0,i.jsx)(r.li,{children:"Basic Python or C++ programming knowledge"}),"\n",(0,i.jsx)(r.li,{children:"Understanding of ROS 2 basic concepts"}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"lab-setup",children:"Lab Setup"}),"\n",(0,i.jsx)(r.h3,{id:"creating-a-new-package",children:"Creating a New Package"}),"\n",(0,i.jsx)(r.p,{children:"First, create a new ROS 2 package for our lab:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Create the package\r\nros2 pkg create --build-type ament_python publisher_subscriber_lab\r\n\r\n# Navigate to the package directory\r\ncd publisher_subscriber_lab\n"})}),"\n",(0,i.jsx)(r.h3,{id:"package-structure",children:"Package Structure"}),"\n",(0,i.jsx)(r.p,{children:"Your package structure should look like this:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"publisher_subscriber_lab/\r\n\u251c\u2500\u2500 publisher_subscriber_lab/\r\n\u2502   \u251c\u2500\u2500 __init__.py\r\n\u2502   \u251c\u2500\u2500 publisher_node.py\r\n\u2502   \u2514\u2500\u2500 subscriber_node.py\r\n\u251c\u2500\u2500 test/\r\n\u251c\u2500\u2500 package.xml\r\n\u251c\u2500\u2500 setup.cfg\r\n\u251c\u2500\u2500 setup.py\r\n\u2514\u2500\u2500 README.md\n"})}),"\n",(0,i.jsx)(r.h2,{id:"step-1-creating-the-publisher-node",children:"Step 1: Creating the Publisher Node"}),"\n",(0,i.jsx)(r.p,{children:"Create the publisher node that will generate and publish messages:"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsxs)(r.strong,{children:["File: ",(0,i.jsx)(r.code,{children:"publisher_subscriber_lab/publisher_node.py"})]})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\nimport random\r\nimport time\r\n\r\nclass MinimalPublisher(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('minimal_publisher')\r\n\r\n        # Create a publisher with String message type on 'topic' topic\r\n        self.publisher_ = self.create_publisher(String, 'topic', 10)\r\n\r\n        # Set timer period to 0.5 seconds (2 Hz)\r\n        timer_period = 0.5\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n\r\n        # Counter for message numbering\r\n        self.i = 0\r\n\r\n        # Log that the publisher is starting\r\n        self.get_logger().info('Publisher node initialized')\r\n\r\n    def timer_callback(self):\r\n        # Create a String message\r\n        msg = String()\r\n        msg.data = f'Hello World: {self.i}'\r\n\r\n        # Publish the message\r\n        self.publisher_.publish(msg)\r\n\r\n        # Log the published message\r\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\r\n\r\n        # Increment the counter\r\n        self.i += 1\r\n\r\ndef main(args=None):\r\n    # Initialize the ROS client library\r\n    rclpy.init(args=args)\r\n\r\n    # Create the publisher node\r\n    minimal_publisher = MinimalPublisher()\r\n\r\n    try:\r\n        # Spin the node to process callbacks\r\n        rclpy.spin(minimal_publisher)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        # Clean up\r\n        minimal_publisher.destroy_node()\r\n        rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.h2,{id:"step-2-creating-the-subscriber-node",children:"Step 2: Creating the Subscriber Node"}),"\n",(0,i.jsx)(r.p,{children:"Create the subscriber node that will receive and process messages:"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsxs)(r.strong,{children:["File: ",(0,i.jsx)(r.code,{children:"publisher_subscriber_lab/subscriber_node.py"})]})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"import rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass MinimalSubscriber(Node):\r\n\r\n    def __init__(self):\r\n        super().__init__('minimal_subscriber')\r\n\r\n        # Create a subscription to 'topic' with String message type\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'topic',\r\n            self.listener_callback,\r\n            10)  # QoS history depth\r\n\r\n        # Prevent unused variable warning\r\n        self.subscription  # prevent unused variable warning\r\n\r\n        # Log that the subscriber is starting\r\n        self.get_logger().info('Subscriber node initialized')\r\n\r\n    def listener_callback(self, msg):\r\n        # Log the received message\r\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\r\n\r\ndef main(args=None):\r\n    # Initialize the ROS client library\r\n    rclpy.init(args=args)\r\n\r\n    # Create the subscriber node\r\n    minimal_subscriber = MinimalSubscriber()\r\n\r\n    try:\r\n        # Spin the node to process callbacks\r\n        rclpy.spin(minimal_subscriber)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        # Clean up\r\n        minimal_subscriber.destroy_node()\r\n        rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(r.h2,{id:"step-3-configuring-the-package",children:"Step 3: Configuring the Package"}),"\n",(0,i.jsxs)(r.p,{children:["Update the ",(0,i.jsx)(r.code,{children:"setup.py"})," file to make the nodes executable:"]}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsxs)(r.strong,{children:["File: ",(0,i.jsx)(r.code,{children:"setup.py"})]})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from setuptools import find_packages, setup\r\n\r\npackage_name = 'publisher_subscriber_lab'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='0.0.0',\r\n    packages=find_packages(exclude=['test']),\r\n    data_files=[\r\n        ('share/ament_index/resource_index/packages',\r\n            ['resource/' + package_name]),\r\n        ('share/' + package_name, ['package.xml']),\r\n    ],\r\n    install_requires=['setuptools'],\r\n    zip_safe=True,\r\n    maintainer='Your Name',\r\n    maintainer_email='your.email@example.com',\r\n    description='A simple publisher-subscriber lab for ROS 2',\r\n    license='Apache-2.0',\r\n    tests_require=['pytest'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'publisher = publisher_subscriber_lab.publisher_node:main',\r\n            'subscriber = publisher_subscriber_lab.subscriber_node:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,i.jsx)(r.h2,{id:"step-4-building-the-package",children:"Step 4: Building the Package"}),"\n",(0,i.jsx)(r.p,{children:"Build your package:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"cd ~/ros2_ws  # or your ROS workspace\r\ncolcon build --packages-select publisher_subscriber_lab\r\nsource install/setup.bash\n"})}),"\n",(0,i.jsx)(r.h2,{id:"step-5-running-the-nodes",children:"Step 5: Running the Nodes"}),"\n",(0,i.jsx)(r.p,{children:"Open two terminal windows and source your ROS workspace in both:"}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Terminal 1 (Publisher):"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"source ~/ros2_ws/install/setup.bash\r\nros2 run publisher_subscriber_lab publisher\n"})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Terminal 2 (Subscriber):"})}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"source ~/ros2_ws/install/setup.bash\r\nros2 run publisher_subscriber_lab subscriber\n"})}),"\n",(0,i.jsx)(r.p,{children:"You should see the publisher sending messages and the subscriber receiving them:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:'# Publisher output:\r\n[INFO] [1680000000.123456789] [minimal_publisher]: Publishing: "Hello World: 0"\r\n[INFO] [1680000000.623456789] [minimal_publisher]: Publishing: "Hello World: 1"\r\n...\r\n\r\n# Subscriber output:\r\n[INFO] [1680000000.123456789] [minimal_subscriber]: I heard: "Hello World: 0"\r\n[INFO] [1680000000.623456789] [minimal_subscriber]: I heard: "Hello World: 1"\r\n...\n'})}),"\n",(0,i.jsx)(r.h2,{id:"step-6-advanced-exercise---custom-message",children:"Step 6: Advanced Exercise - Custom Message"}),"\n",(0,i.jsx)(r.p,{children:"Create a custom message to practice more complex communication:"}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsx)(r.li,{children:"Create a directory for custom messages:"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"mkdir msg\n"})}),"\n",(0,i.jsxs)(r.ol,{start:"2",children:["\n",(0,i.jsxs)(r.li,{children:["Create a custom message definition in ",(0,i.jsx)(r.code,{children:"msg/Num.msg"}),":"]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"int64 num\r\nstring description\r\nfloat64 value\n"})}),"\n",(0,i.jsxs)(r.ol,{start:"3",children:["\n",(0,i.jsxs)(r.li,{children:["Update ",(0,i.jsx)(r.code,{children:"package.xml"})," to include message generation dependencies:"]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-xml",children:"<depend>builtin_interfaces</depend>\r\n<depend>std_msgs</depend>\r\n<build_depend>rosidl_default_generators</build_depend>\r\n<exec_depend>rosidl_default_runtime</exec_depend>\r\n<member_of_group>rosidl_interface_packages</member_of_group>\n"})}),"\n",(0,i.jsxs)(r.ol,{start:"4",children:["\n",(0,i.jsxs)(r.li,{children:["Update ",(0,i.jsx)(r.code,{children:"setup.py"})," to include message generation:"]}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from setuptools import find_packages, setup\r\nimport os\r\nfrom glob import glob\r\n\r\npackage_name = 'publisher_subscriber_lab'\r\n\r\nsetup(\r\n    name=package_name,\r\n    version='0.0.0',\r\n    packages=find_packages(exclude=['test']),\r\n    data_files=[\r\n        ('share/ament_index/resource_index/packages',\r\n            ['resource/' + package_name]),\r\n        ('share/' + package_name, ['package.xml']),\r\n        # Include custom message files\r\n        (os.path.join('share', package_name, 'msg'), glob('msg/*')),\r\n    ],\r\n    install_requires=['setuptools'],\r\n    zip_safe=True,\r\n    maintainer='Your Name',\r\n    maintainer_email='your.email@example.com',\r\n    description='A simple publisher-subscriber lab for ROS 2',\r\n    license='Apache-2.0',\r\n    tests_require=['pytest'],\r\n    entry_points={\r\n        'console_scripts': [\r\n            'publisher = publisher_subscriber_lab.publisher_node:main',\r\n            'subscriber = publisher_subscriber_lab.subscriber_node:main',\r\n        ],\r\n    },\r\n)\n"})}),"\n",(0,i.jsx)(r.h2,{id:"verification",children:"Verification"}),"\n",(0,i.jsx)(r.p,{children:"To verify your implementation:"}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsx)(r.li,{children:"Check that nodes are running:"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"ros2 node list\n"})}),"\n",(0,i.jsxs)(r.ol,{start:"2",children:["\n",(0,i.jsx)(r.li,{children:"Check the topic connection:"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"ros2 topic list\r\nros2 topic info /topic\n"})}),"\n",(0,i.jsxs)(r.ol,{start:"3",children:["\n",(0,i.jsx)(r.li,{children:"Echo the topic to see messages:"}),"\n"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"ros2 topic echo /topic std_msgs/msg/String\n"})}),"\n",(0,i.jsx)(r.h2,{id:"expected-outcome",children:"Expected Outcome"}),"\n",(0,i.jsx)(r.p,{children:"After completing this lab, you should be able to:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Create a ROS 2 package with publisher and subscriber nodes"}),"\n",(0,i.jsx)(r.li,{children:"Implement publish-subscribe communication pattern"}),"\n",(0,i.jsx)(r.li,{children:"Run multiple nodes and observe their interaction"}),"\n",(0,i.jsx)(r.li,{children:"Understand the basic structure of ROS 2 nodes"}),"\n"]}),"\n",(0,i.jsx)(r.h2,{id:"references",children:"References"}),"\n",(0,i.jsx)(r.p,{children:"[All sources will be cited in the References section at the end of the book, following APA format]"}),"\n",(0,i.jsx)(r.p,{children:"(Quigley et al., 2009) Quigley, M., Conley, K., Gerkey, B. P., Faust, J., Foote, T., Leibs, J., ... & Ng, A. Y. (2009). ROS: an open-source Robot Operating System. ICRA Workshop on Open Source Software, 3(3.2), 5."})]})}function u(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,r,n){n.d(r,{R:()=>l,x:()=>t});var s=n(6540);const i={},a=s.createContext(i);function l(e){const r=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(a.Provider,{value:r},e.children)}}}]);